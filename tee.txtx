enriched_result : [{'domain': 'crm', 'software_name': 'odoo', 'software_url': 'https://www.odoo.com/', 'features': ['User Interface', 'Contact Management', 'Contract Flexibility', 'Customer Support', 'Customization Options', 'Data Import/Export', 'Ease of Implementation', 'Email Integration', 'Free Trial Period', 'Integration Capabilities', 'Marketing Automation', 'Mobile Accessibility', 'Pipeline Management', 'Pricing Structure', 'Reporting and Analytics', 'Scalability', 'Security Features', 'Social Media Integration', 'Task Automation', 'Training Resources'], 'feature_descriptions': ['Intuitive, clean design that requires minimal training and encourages team adoption', 'Comprehensive tools for storing, organizing, and accessing customer information with custom fields and tagging', 'Month-to-month options or short-term commitments that reduce risk for early-stage companies', 'Available support channels (chat, email, phone) with response times that match your business needs', 'Ability to tailor fields, workflows, and processes to match your specific business needs without requiring developers', 'Easy tools to migrate existing customer data into the system and export data when needed', 'Quick setup process with minimal technical expertise required, allowing for rapid deployment', 'Seamless connection with email providers for tracking communications and enabling templates', 'Opportunity to test the platform with your team before committing to a paid plan', 'Pre-built connectors or APIs for essential business tools like email, marketing platforms, billing systems, and communication tools', 'Basic marketing tools like email campaigns, lead scoring, and audience segmentation', 'Robust mobile apps or responsive design that allows team members to access and update CRM data on the go', 'Visual sales pipeline tracking with customizable stages and probability scoring', 'Transparent, predictable pricing that fits startup budgets, ideally with a per-user model and no hidden costs', 'Built-in reporting tools with customizable dashboards to track KPIs and sales performance', 'The ability to grow with your business, adding users, data, and functionality without performance degradation or significant cost increases', 'Data encryption, role-based permissions, two-factor authentication, and compliance with relevant regulations', 'Ability to monitor and engage with prospects and customers across social platforms', 'Workflow tools that automate repetitive tasks, follow-ups, and data entry to save time and reduce errors', 'Documentation, tutorials, webinars, and onboarding assistance to help your team become proficient'], 'llm_summary': AIMessage(content="# Odoo CRM Overview\n\n## Core Platform Strengths\n\nOdoo offers a comprehensive CRM solution with an intuitive, clean user interface that requires minimal training, making it highly accessible for teams of all technical backgrounds. The platform stands out for its extensive customization capabilities that don't necessarily require developer expertise, allowing businesses to tailor fields, workflows, and processes to their specific needs.\n\n## Key Features\n\n- **Contact Management**: Comprehensive tools for organizing customer information with custom fields and tagging\n- **Pipeline Management**: Visual sales pipeline with customizable stages and probability scoring\n- **Marketing Automation**: Basic tools for email campaigns, lead scoring, and audience segmentation\n- **Integration Capabilities**: Pre-built connectors and APIs for essential business tools\n- **Mobile Accessibility**: Robust mobile apps and responsive design for on-the-go CRM access\n- **Task Automation**: Workflow tools to automate repetitive tasks and follow-ups\n- **Reporting and Analytics**: Built-in customizable dashboards for tracking KPIs and sales performance\n\n## Pricing Structure\n\nOdoo offers a transparent, predictable pricing model that typically works on a per-user basis with no hidden costs, making it suitable for startup budgets. The platform provides:\n\n- **Free Trial Period**: Opportunity to test the platform before committing to a paid plan\n- **Contract Flexibility**: Month-to-month options or short-term commitments, reducing risk for early-stage companies\n- **Scalability**: Ability to add users, data, and functionality as your business grows without significant cost increases\n\n## Implementation & Support\n\n- **Ease of Implementation**: Quick setup process requiring minimal technical expertise\n- **Data Import/Export**: Easy tools for migrating existing customer data\n- **Customer Support**: Multiple support channels including chat, email, and phone\n- **Training Resources**: Comprehensive documentation, tutorials, webinars, and onboarding assistance\n\n## Security & Technical Aspects\n\n- **Security Features**: Data encryption, role-based permissions, two-factor authentication, and regulatory compliance\n- **Email Integration**: Seamless connection with email providers for tracking communications\n- **Social Media Integration**: Tools to monitor and engage with prospects across social platforms\n\nOdoo's CRM solution offers a balanced combination of user-friendliness, customization options, and scalability, making it suitable for businesses looking for a flexible system that can grow with their needs while maintaining budget predictability.", additional_kwargs={}, response_metadata={'id': 'msg_01Dw9R4YJCTvVhc962u4Ec6z', 'model': 'claude-3-7-sonnet-20250219', 'stop_reason': 'end_turn', 'stop_sequence': None, 'usage': {'cache_creation': {'ephemeral_1h_input_tokens': 0, 'ephemeral_5m_input_tokens': 0}, 'cache_creation_input_tokens': 0, 'cache_read_input_tokens': 0, 'input_tokens': 499, 'output_tokens': 527, 'server_tool_use': None, 'service_tier': 'standard'}, 'model_name': 'claude-3-7-sonnet-20250219'}, id='run--452fd635-85ec-4b81-86a8-4e6b1e20f73f-0', usage_metadata={'input_tokens': 499, 'output_tokens': 527, 'total_tokens': 1026, 'input_token_details': {'cache_read': 0, 'cache_creation': 0, 'ephemeral_5m_input_tokens': 0, 'ephemeral_1h_input_tokens': 0}})}]
enriched_result : [{'domain': 'crm', 'software_name': 'odoo', 'software_url': 'https://www.odoo.com/', 'features': ['User Interface', 'Contact Management', 'Contract Flexibility', 'Customer Support', 'Customization Options', 'Data Import/Export', 'Ease of Implementation', 'Email Integration', 'Free Trial Period', 'Integration Capabilities', 'Marketing Automation', 'Mobile Accessibility', 'Pipeline Management', 'Pricing Structure', 'Reporting and Analytics', 'Scalability', 'Security Features', 'Social Media Integration', 'Task Automation', 'Training Resources'], 'feature_descriptions': ['Intuitive, clean design that requires minimal training and encourages team adoption', 'Comprehensive tools for storing, organizing, and accessing customer information with custom fields and tagging', 'Month-to-month options or short-term commitments that reduce risk for early-stage companies', 'Available support channels (chat, email, phone) with response times that match your business needs', 'Ability to tailor fields, workflows, and processes to match your specific business needs without requiring developers', 'Easy tools to migrate existing customer data into the system and export data when needed', 'Quick setup process with minimal technical expertise required, allowing for rapid deployment', 'Seamless connection with email providers for tracking communications and enabling templates', 'Opportunity to test the platform with your team before committing to a paid plan', 'Pre-built connectors or APIs for essential business tools like email, marketing platforms, billing systems, and communication tools', 'Basic marketing tools like email campaigns, lead scoring, and audience segmentation', 'Robust mobile apps or responsive design that allows team members to access and update CRM data on the go', 'Visual sales pipeline tracking with customizable stages and probability scoring', 'Transparent, predictable pricing that fits startup budgets, ideally with a per-user model and no hidden costs', 'Built-in reporting tools with customizable dashboards to track KPIs and sales performance', 'The ability to grow with your business, adding users, data, and functionality without performance degradation or significant cost increases', 'Data encryption, role-based permissions, two-factor authentication, and compliance with relevant regulations', 'Ability to monitor and engage with prospects and customers across social platforms', 'Workflow tools that automate repetitive tasks, follow-ups, and data entry to save time and reduce errors', 'Documentation, tutorials, webinars, and onboarding assistance to help your team become proficient'], 'llm_summary': AIMessage(content="# Odoo CRM Overview\n\n## Core Platform Strengths\n\nOdoo offers a comprehensive CRM solution with an intuitive, clean user interface that requires minimal training, making it highly accessible for teams of all technical backgrounds. The platform stands out for its extensive customization capabilities that don't necessarily require developer expertise, allowing businesses to tailor fields, workflows, and processes to their specific needs.\n\n## Key Features\n\n- **Contact Management**: Comprehensive tools for organizing customer information with custom fields and tagging\n- **Pipeline Management**: Visual sales pipeline with customizable stages and probability scoring\n- **Marketing Automation**: Basic tools for email campaigns, lead scoring, and audience segmentation\n- **Integration Capabilities**: Pre-built connectors and APIs for essential business tools\n- **Mobile Accessibility**: Robust mobile apps and responsive design for on-the-go CRM access\n- **Task Automation**: Workflow tools to automate repetitive tasks and follow-ups\n- **Reporting and Analytics**: Built-in customizable dashboards for tracking KPIs and sales performance\n\n## Pricing Structure\n\nOdoo offers a transparent, predictable pricing model that typically works on a per-user basis with no hidden costs, making it suitable for startup budgets. The platform provides:\n\n- **Free Trial Period**: Opportunity to test the platform before committing to a paid plan\n- **Contract Flexibility**: Month-to-month options or short-term commitments, reducing risk for early-stage companies\n- **Scalability**: Ability to add users, data, and functionality as your business grows without significant cost increases\n\n## Implementation & Support\n\n- **Ease of Implementation**: Quick setup process requiring minimal technical expertise\n- **Data Import/Export**: Easy tools for migrating existing customer data\n- **Customer Support**: Multiple support channels including chat, email, and phone\n- **Training Resources**: Comprehensive documentation, tutorials, webinars, and onboarding assistance\n\n## Security & Technical Aspects\n\n- **Security Features**: Data encryption, role-based permissions, two-factor authentication, and regulatory compliance\n- **Email Integration**: Seamless connection with email providers for tracking communications\n- **Social Media Integration**: Tools to monitor and engage with prospects across social platforms\n\nOdoo's CRM solution offers a balanced combination of user-friendliness, customization options, and scalability, making it suitable for businesses looking for a flexible system that can grow with their needs while maintaining budget predictability.", additional_kwargs={}, response_metadata={'id': 'msg_01Dw9R4YJCTvVhc962u4Ec6z', 'model': 'claude-3-7-sonnet-20250219', 'stop_reason': 'end_turn', 'stop_sequence': None, 'usage': {'cache_creation': {'ephemeral_1h_input_tokens': 0, 'ephemeral_5m_input_tokens': 0}, 'cache_creation_input_tokens': 0, 'cache_read_input_tokens': 0, 'input_tokens': 499, 'output_tokens': 527, 'server_tool_use': None, 'service_tier': 'standard'}, 'model_name': 'claude-3-7-sonnet-20250219'}, id='run--452fd635-85ec-4b81-86a8-4e6b1e20f73f-0', usage_metadata={'input_tokens': 499, 'output_tokens': 527, 'total_tokens': 1026, 'input_token_details': {'cache_read': 0, 'cache_creation': 0, 'ephemeral_5m_input_tokens': 0, 'ephemeral_1h_input_tokens': 0}})}, {'domain': 'crm', 'software_name': 'znicrm', 'software_url': 'https://znicrm.com/', 'features': ['Contact Management', 'Contract Flexibility', 'Customer Support', 'Customization Options', 'Data Import/Export', 'Ease of Implementation', 'Email Integration', 'Free Trial Period', 'Integration Capabilities', 'Marketing Automation', 'Mobile Accessibility', 'Pipeline Management', 'Pricing Structure', 'Reporting and Analytics', 'Scalability', 'Security Features', 'Social Media Integration', 'Task Automation', 'Training Resources', 'User Interface'], 'feature_descriptions': ['Comprehensive tools for storing, organizing, and accessing customer information with custom fields and tagging', 'Month-to-month options or short-term commitments that reduce risk for early-stage companies', 'Available support channels (chat, email, phone) with response times that match your business needs', 'Ability to tailor fields, workflows, and processes to match your specific business needs without requiring developers', 'Easy tools to migrate existing customer data into the system and export data when needed', 'Quick setup process with minimal technical expertise required, allowing for rapid deployment', 'Seamless connection with email providers for tracking communications and enabling templates', 'Opportunity to test the platform with your team before committing to a paid plan', 'Pre-built connectors or APIs for essential business tools like email, marketing platforms, billing systems, and communication tools', 'Basic marketing tools like email campaigns, lead scoring, and audience segmentation', 'Robust mobile apps or responsive design that allows team members to access and update CRM data on the go', 'Visual sales pipeline tracking with customizable stages and probability scoring', 'Transparent, predictable pricing that fits startup budgets, ideally with a per-user model and no hidden costs', 'Built-in reporting tools with customizable dashboards to track KPIs and sales performance', 'The ability to grow with your business, adding users, data, and functionality without performance degradation or significant cost increases', 'Data encryption, role-based permissions, two-factor authentication, and compliance with relevant regulations', 'Ability to monitor and engage with prospects and customers across social platforms', 'Workflow tools that automate repetitive tasks, follow-ups, and data entry to save time and reduce errors', 'Documentation, tutorials, webinars, and onboarding assistance to help your team become proficient', 'Intuitive, clean design that requires minimal training and encourages team adoption'], 'llm_summary': AIMessage(content='# ZniCRM Overview\n\nZniCRM (https://znicrm.com/) is a customer relationship management platform designed with flexibility and ease of use in mind, making it particularly suitable for startups and growing businesses.\n\n## Pricing Structure\n- Offers transparent, predictable per-user pricing model with no hidden costs\n- Designed to fit startup budgets\n- Month-to-month options available, reducing financial risk for early-stage companies\n- Short-term commitments available (no long-term contracts required)\n- Free trial period to test the platform before committing financially\n\n## Key Features\n\n### Core Functionality\n- **Contact Management**: Comprehensive tools for storing and organizing customer information with custom fields and tagging\n- **Pipeline Management**: Visual sales tracking with customizable stages and probability scoring\n- **Reporting and Analytics**: Built-in tools with customizable dashboards for tracking KPIs and sales performance\n- **Marketing Automation**: Basic tools including email campaigns, lead scoring, and audience segmentation\n\n### Usability & Implementation\n- **User Interface**: Intuitive, clean design requiring minimal training\n- **Ease of Implementation**: Quick setup with minimal technical expertise\n- **Mobile Accessibility**: Robust mobile apps or responsive design for on-the-go access\n- **Customization**: Ability to tailor fields, workflows, and processes without developers\n\n### Integration & Data Management\n- **Integration Capabilities**: Pre-built connectors/APIs for email, marketing platforms, billing systems\n- **Email Integration**: Seamless connection with email providers for tracking communications\n- **Data Import/Export**: Easy tools for migrating existing data and exporting when needed\n- **Social Media Integration**: Monitor and engage with prospects across social platforms\n\n### Business Growth Support\n- **Scalability**: Grows with your business without performance degradation or significant cost increases\n- **Task Automation**: Workflow tools to automate repetitive tasks and follow-ups\n- **Security Features**: Data encryption, role-based permissions, two-factor authentication, and regulatory compliance\n\n### Support & Resources\n- **Customer Support**: Multiple channels (chat, email, phone) with responsive service\n- **Training Resources**: Documentation, tutorials, webinars, and onboarding assistance\n\n## Key Advantages\n- Flexible contract terms ideal for startups uncertain about long-term needs\n- User-friendly interface that encourages team adoption\n- Balance of functionality and simplicity without overwhelming new users\n- Customization without requiring technical expertise\n- Scalable solution that can grow alongside your business\n\nZniCRM positions itself as a solution that reduces both financial and implementation risk while providing the essential CRM functionality needed for growing businesses.', additional_kwargs={}, response_metadata={'id': 'msg_0171CQ2Kmp2JCTe5hNg252PZ', 'model': 'claude-3-7-sonnet-20250219', 'stop_reason': 'end_turn', 'stop_sequence': None, 'usage': {'cache_creation': {'ephemeral_1h_input_tokens': 0, 'ephemeral_5m_input_tokens': 0}, 'cache_creation_input_tokens': 0, 'cache_read_input_tokens': 0, 'input_tokens': 501, 'output_tokens': 579, 'server_tool_use': None, 'service_tier': 'standard'}, 'model_name': 'claude-3-7-sonnet-20250219'}, id='run--43873f47-7473-4f63-a2c6-8899567e774d-0', usage_metadata={'input_tokens': 501, 'output_tokens': 579, 'total_tokens': 1080, 'input_token_details': {'cache_read': 0, 'cache_creation': 0, 'ephemeral_5m_input_tokens': 0, 'ephemeral_1h_input_tokens': 0}})}]


 # Crating domain table 
        query = "SELECT table_name \
        FROM information_schema.tables \
        WHERE table_schema = 'public' \
        AND table_type = 'BASE TABLE';"
        try:
            res = db.execute_query(query)
            print(res)
        except Exception as e:
            print(f"Query failed: {e}")
            db.connection.rollback()
            success = False



-- WARNING: This schema is for context only and is not meant to be run.
-- Table order and constraints may not be valid for execution.

CREATE TABLE public.database (
  id integer NOT NULL DEFAULT nextval('database_id_seq'::regclass),
  software text,
  scalability text,
  pricing_model text,
  performance text,
  reliability_&_uptime text,
  security_features text,
  data_model_support text,
  backup_&_recovery text,
  integration_capabilities text,
  developer_experience text,
  migration_tools text,
  monitoring_&_analytics text,
  geographic_distribution text,
  vendor_lock-in_risk text,
  compliance_support text,
  technical_support text,
  CONSTRAINT database_pkey PRIMARY KEY (id),
  CONSTRAINT fk_software FOREIGN KEY (software) REFERENCES public.softwares(software_name)
);
CREATE TABLE public.domains (
  id bigint GENERATED ALWAYS AS IDENTITY NOT NULL,
  created_at timestamp with time zone NOT NULL DEFAULT now(),
  domain text NOT NULL UNIQUE,
  CONSTRAINT domains_pkey PRIMARY KEY (id, domain)
);
CREATE TABLE public.feature (
  id bigint GENERATED ALWAYS AS IDENTITY NOT NULL,
  created_at timestamp with time zone NOT NULL DEFAULT now(),
  domain text,
  feature text,
  feature_description text,
  CONSTRAINT feature_pkey PRIMARY KEY (id),
  CONSTRAINT feature_domain_fkey FOREIGN KEY (domain) REFERENCES public.domains(domain)
);
CREATE TABLE public.notes (
  id integer NOT NULL DEFAULT nextval('notes_id_seq'::regclass),
  content text,
  created_at timestamp without time zone DEFAULT now(),
  CONSTRAINT notes_pkey PRIMARY KEY (id)
);
CREATE TABLE public.softwares (
  id integer NOT NULL DEFAULT nextval('softwares_id_seq'::regclass),
  created_at timestamp without time zone DEFAULT now(),
  domain text NOT NULL,
  software_name text NOT NULL UNIQUE,
  software_url text UNIQUE,
  CONSTRAINT softwares_pkey PRIMARY KEY (id, software_name),
  CONSTRAINT softwares_domain_fkey FOREIGN KEY (domain) REFERENCES public.domains(domain)
);

create table public.crm (
  id serial not null,
  created_at timestamp without time zone null default now(),
  software text null,
  api_access text null,
  automation_capabilities text null,
  contact_management text null,
  customer_support text null,
  customization_options text null,
  data_import / export text null,
  document_management text null,
  ease_of_use text null,
  email_integration text null,
  free_trial_period text null,
  implementation_support text null,
  integration_capabilities text null,
  mobile_accessibility text null,
  pricing_structure text null,
  reporting_and_analytics text null,
  sales_pipeline_management text null,
  scalability text null,
  security_features text null,
  social_media_integration text null,
  task_management text null,
  constraint crm_pkey primary key (id),
  constraint fk_software foreign KEY (software) references softwares (software_name)
) TABLESPACE pg_default;

def add_column_if_missing(db, table, column):
    query = f"""
        DO $$
        BEGIN
            IF NOT EXISTS (
                SELECT 1 FROM information_schema.columns
                WHERE table_name='{table}' AND column_name='{column}'
            ) THEN
                EXECUTE 'ALTER TABLE {table} ADD COLUMN \"{column}\" TEXT;';
            END IF;
        END
        $$;
    """
    db.execute_query(query)

# Before upsert, for each col_name:
add_column_if_missing(db, "crm", col_name)